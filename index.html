<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROVA FGV GABARITO - TJRJ 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f1f5f9; }
        .highlight-active {
            animation: highlight-glow 3s ease-out;
            border-color: #2563eb !important;
            background-color: #eff6ff !important;
            box-shadow: 0 0 20px rgba(37, 99, 235, 0.3);
            z-index: 10;
        }
        @keyframes highlight-glow {
            0% { transform: scale(1); }
            10% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }
        .questoes-grid { 
            display: grid; 
            grid-template-columns: repeat(5, minmax(45px, 1fr)); 
            gap: 8px; 
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
    </style>
</head>
<body class="text-slate-900 pb-20">

    <nav class="bg-white border-b-2 border-blue-100 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-6 h-18 flex justify-between items-center py-3">
            <div class="flex items-center gap-3">
                <div class="bg-blue-600 p-2 rounded-lg text-white">
                    <i data-lucide="shield-check" class="w-6 h-6"></i>
                </div>
                <h1 class="font-black text-xl uppercase tracking-tighter italic">FGV Gabarito <span class="text-blue-600">TJRJ</span></h1>
            </div>
            <div class="flex bg-slate-100 p-1.5 rounded-xl border-2 border-slate-200">
                <button onclick="setView('cronograma')" id="btn-cron" class="px-4 py-2 rounded-lg text-[10px] md:text-xs font-black uppercase transition-all">Cronograma</button>
                <button onclick="setView('edital')" id="btn-edit" class="px-4 py-2 rounded-lg text-[10px] md:text-xs font-black uppercase transition-all">Edital Vertical</button>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto p-4 md:p-6">
        
        <!-- Dashboard de Performance -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
            <div class="bg-white p-5 rounded-2xl border-2 border-slate-100 shadow-sm flex items-center gap-4">
                <div class="bg-blue-50 p-3 rounded-full"><i data-lucide="trending-up" class="w-6 h-6 text-blue-600"></i></div>
                <div>
                    <p class="text-[11px] font-bold text-slate-400 uppercase tracking-widest">Média (Máx 20)</p>
                    <p id="avg-score" class="font-black text-3xl text-blue-700 leading-none">0.0</p>
                </div>
            </div>
            <div class="bg-white p-5 rounded-2xl border-2 border-slate-100 shadow-sm flex items-center gap-4">
                <div class="bg-emerald-50 p-3 rounded-full"><i data-lucide="check-circle" class="w-6 h-6 text-emerald-600"></i></div>
                <div>
                    <p class="text-[11px] font-bold text-slate-400 uppercase tracking-widest">Tópicos Lidos</p>
                    <p id="topics-count" class="font-black text-3xl text-emerald-700 leading-none">0/0</p>
                </div>
            </div>
            <div class="bg-slate-900 p-5 rounded-2xl border-2 border-slate-800 shadow-lg flex items-center gap-4 text-white">
                <div class="bg-blue-500/20 p-3 rounded-full"><i data-lucide="clock" class="w-6 h-6 text-blue-400"></i></div>
                <div class="flex-1">
                    <p class="text-[11px] font-bold text-slate-400 uppercase tracking-widest flex justify-between">
                        <span>Tempo Restante</span>
                        <span id="perc-label" class="text-blue-400">0%</span>
                    </p>
                    <p id="countdown-timer" class="font-black text-xl leading-none tabular-nums mt-1 text-blue-50">00d 00h 00m 00s</p>
                </div>
            </div>
        </div>

        <div id="view-cronograma" class="space-y-6">
            <div class="flex items-center gap-3 overflow-x-auto pb-3 no-scrollbar" id="week-tabs"></div>
            <div id="week-content" class="space-y-5"></div>
        </div>

        <div id="view-edital" class="hidden">
            <div id="edital-content" class="grid grid-cols-1 lg:grid-cols-2 gap-6"></div>
        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Configurações fornecidas aplicadas com prioridade para o ambiente
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
           
        };

        const appId = typeof __app_id !== 'undefined' ? __app_id : 'tjrj-fgv-gabarito-v3';
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Banco de Dados do Edital (Conforme seu código)
        const EDITAL = {
            "Língua Portuguesa": [
                { id: "lp-1", t: "1. Compreensão e interpretação de textos", sub: "1", week: 1, ref: "Técnicas FGV: Inferência, Pressupostos e Tipologia" },
                { id: "lp-2", t: "2. Reconhecimento de tipos e gêneros", sub: "2", week: 1, ref: "Narração, Descrição, Dissertação (Foco em Injunção FGV)" },
                { id: "lp-3", t: "3.1 Emprego das letras", sub: "3.1", week: 1, ref: "Novo Acordo Ortográfico (Hifens e Acentuação)" },
                { id: "lp-4", t: "3.2 Emprego da acentuação gráfica", sub: "3.2", week: 1, ref: "Regras Gerais e Proparoxítonas (Padrão FGV)" },
                { id: "lp-5", t: "4.1 Mecanismos de coesão textual", sub: "4.1", week: 2, ref: "Anáfora, Catáfora e Conectivos Lógicos" },
                { id: "lp-6", t: "4.2 Emprego/correlação de tempos e modos verbais", sub: "4.2", week: 2, ref: "Subjuntivo e Correlação Temporal" },
                { id: "lp-7", t: "5.1/5.2 Estrutura Morfossintática", sub: "5.1/5.2", week: 3, ref: "Classes de Palavras e Termos da Oração" },
                { id: "lp-8", t: "5.3/5.4 Pontuação e Concordância", sub: "5.3/5.4", week: 3, ref: "Vírgula e Concordância Verbal (Sujeito Oracional)" },
                { id: "lp-9", t: "5.5/5.6 Crase e Pronomes", sub: "5.5/5.6", week: 4, ref: "Colocação Pronominal e Casos Proibitivos de Crase" },
                { id: "lp-10", t: "6. Reescritura e Retextualização", sub: "6", week: 4, ref: "Sinonímia e Mantimento do Sentido Original" }
            ],
            "Legislação Especial": [
                { id: "le-1", t: "1. Lei Estadual nº 10.633/2024", sub: "1", week: 1, ref: "Fundo Especial do TJRJ (FETJ)" },
                { id: "le-2", t: "2/3. Estatuto (DL 220/75 e Dec 2.479/79)", sub: "2/3", week: 1, ref: "Regime Jurídico dos Servidores do RJ" },
                { id: "le-3", t: "4. Quadro Único (Lei 9.748/22)", sub: "4", week: 2, ref: "Carreira, Progressão e Vencimentos TJRJ" },
                { id: "le-4", t: "5.1.1/5.1.2 Atos e Função Correicional", sub: "5.1.1/5.1.2", week: 2, ref: "CODJERJ - Parte Administrativa" },
                { id: "le-5", t: "5.1.4/5.1.5 Deveres e Custas Judiciais", sub: "5.1.4/5.1.5", week: 3, ref: "Lei de Custas RJ (Lei 3.350/99)" },
                { id: "le-6", t: "6. Regimento Interno do TJRJ", sub: "6", week: 3, ref: "Competência das Câmaras e Órgão Especial" },
                { id: "le-7", t: "7. Resolução OE nº 3/2025", sub: "7", week: 4, ref: "Nova Estrutura Organizacional das Secretarias" }
            ],
            "Direito Administrativo": [
                { id: "da-1", t: "1/2. Organização e Administração", sub: "1/2", week: 1, ref: "Direta/Indireta (Autarquias e Fundações)" },
                { id: "da-2", t: "3. Ato Administrativo", sub: "3", week: 1, ref: "Atributos (PATI) e Extinção (Anulação/Revogação)" },
                { id: "da-3", t: "4/5. Processo e Agentes Públicos", sub: "4/5", week: 2, ref: "Lei 9.784/99 e Lei 8.112 (Base Doutrinária)" },
                { id: "da-4", t: "6. Poderes Administrativos", sub: "6", week: 2, ref: "Hierárquico, Disciplinar, Regulamentar e Polícia" },
                { id: "da-5", t: "7. Lei nº 14.133/2021", sub: "7", week: 3, ref: "Licitações: Modalidades e Dispensa (Art. 72-75)" },
                { id: "da-6", t: "8. Controle e Responsabilização", sub: "8", week: 4, ref: "Resp. Civil do Estado (Art. 37, §6º CF)" }
            ],
            "Direito Constitucional": [
                { id: "dc-1", t: "1.1 Princípios Fundamentais", sub: "1.1", week: 1, ref: "Art. 1º ao 4º da CF/88" },
                { id: "dc-2", t: "1.2 Direitos e Garantias Fundamentais", sub: "1.2", week: 1, ref: "Art. 5º (Remédios e Direitos Individuais)" },
                { id: "dc-3", t: "1.3/1.4 Org. Estado e Adm Pública", sub: "1.3/1.4", week: 2, ref: "Art. 18 ao 43 da CF/88" },
                { id: "dc-4", t: "1.5/1.6 Poder Legislativo e Executivo", sub: "1.5/1.6", week: 3, ref: "Art. 44 ao 91 da CF/88" },
                { id: "dc-5", t: "1.7 Poder Judiciário e CNJ", sub: "1.7", week: 3, ref: "Art. 92 ao 126 da CF/88" },
                { id: "dc-6", t: "1.8 Funções Essenciais à Justiça", sub: "1.8", week: 4, ref: "Art. 127 ao 135 (MP, DP e Advocacia)" }
            ],
            "Processo Civil": [
                { id: "pc-1", t: "1/2/3. Princípios, Jurisdição e Ação", sub: "1/2/3", week: 1, ref: "Art. 1º ao 25 do CPC/15" },
                { id: "pc-2", t: "5/6. Competência e Pressupostos", sub: "5/6", week: 1, ref: "Art. 42 ao 69 do CPC/15" },
                { id: "pc-3", t: "8/9/10. Sujeitos, Intervenção e Juiz", sub: "8/9/10", week: 2, ref: "Art. 70 ao 155 do CPC/15" },
                { id: "pc-4", t: "14. Atos Processuais", sub: "14", week: 2, ref: "Art. 188 ao 275 (Prazos e Citações)" },
                { id: "pc-5", t: "15/16. Tutela e Formação Processo", sub: "15/16", week: 3, ref: "Art. 294 ao 317 (Urgência e Evidência)" },
                { id: "pc-6", t: "17. Proc. Conhecimento e Sentença", sub: "17", week: 3, ref: "Art. 318 ao 508 do CPC/15" },
                { id: "pc-7", t: "18. Recursos", sub: "18", week: 4, ref: "Art. 994 ao 1.044 (Apelação e Agravo)" },
                { id: "pc-8", t: "20/21/22. Mandado, Ação Popular e ACP", sub: "20/22", week: 4, ref: "Leis 12.016/09, 4.717/65 e 7.347/85" }
            ],
            "Processo Penal": [
                { id: "pp-1", t: "1/2/3. Preliminares, Inquérito e Ação", sub: "1/2/3", week: 1, ref: "Art. 1º ao 62 do CPP" },
                { id: "pp-2", t: "4/5. Sujeitos e Citações", sub: "4/5", week: 2, ref: "Art. 251 ao 372 do CPP" },
                { id: "pp-3", t: "7.2 Tribunal do Júri", sub: "7.2", week: 3, ref: "Art. 406 ao 497 do CPP" },
                { id: "pp-4", t: "8. Prisão e Liberdade", sub: "8", week: 4, ref: "Art. 282 ao 350 do CPP" },
                { id: "pp-5", t: "10/11. Habeas Corpus e Const.", sub: "10/11", week: 4, ref: "Art. 647 ao 667 do CPP" }
            ],
            "Ética e PCD": [
                { id: "et-1", t: "1/5. Ética e Função Pública", sub: "1/5", week: 1, ref: "Dec. 1.171/94 e Doutrina" },
                { id: "et-2", t: "6/7. Improbidade e Anticorrupção", sub: "6/7", week: 2, ref: "Lei 8.429/92 (Alterada pela 14.230)" },
                { id: "pcd-1", t: "1. Lei nº 13.146 (Estatuto PCD)", sub: "1", week: 3, ref: "Art. 1º ao 30 do Estatuto" },
                { id: "pcd-2", t: "2/3. Acessibilidade e Prioridade", sub: "2/3", week: 4, ref: "Art. 42 ao 63 da Lei 13.146" }
            ]
        };

        const CRONOGRAMA_MAP = {
            1: [
                { d: 1, m: "Português / Adm", t: ["lp-1", "da-1"] },
                { d: 2, m: "Const / Proc Civil", t: ["dc-1", "pc-1"] },
                { d: 3, m: "Leg Esp / Proc Penal", t: ["le-1", "pp-1"] },
                { d: 4, m: "Ética / Português", t: ["et-1", "lp-2"] },
                { d: 5, m: "Adm / Const", t: ["da-2", "dc-2"] },
                { d: 6, m: "Proc Civil / Leg Esp", t: ["pc-2", "le-2"] },
                { d: 0, m: "Revisão Geral S1", t: ["lp-3", "lp-4"] }
            ],
            2: [
                { d: 1, m: "Português / Adm", t: ["lp-5", "da-3"] },
                { d: 2, m: "Const / Proc Civil", t: ["dc-3", "pc-3"] },
                { d: 3, m: "Leg Esp / Proc Penal", t: ["le-3", "pp-2"] },
                { d: 4, m: "Ética / Português", t: ["et-2", "lp-6"] },
                { d: 5, m: "Adm / Const", t: ["da-4", "dc-3"] },
                { d: 6, m: "Proc Civil / Leg Esp", t: ["pc-4", "le-4"] },
                { d: 0, m: "Revisão Geral S2", t: ["pp-2"] }
            ],
            3: [
                { d: 1, m: "Português / Adm", t: ["lp-7", "da-5"] },
                { d: 2, m: "Const / Proc Civil", t: ["dc-4", "pc-5"] },
                { d: 3, m: "Leg Esp / Proc Penal", t: ["le-5", "pp-3"] },
                { d: 4, m: "PCD / Português", t: ["pcd-1", "lp-8"] },
                { d: 5, m: "Leg Esp / Const", t: ["le-6", "dc-5"] },
                { d: 6, m: "Proc Civil / Adm", t: ["pc-6", "da-5"] },
                { d: 0, m: "Revisão Geral S3", t: ["pcd-1"] }
            ],
            4: [
                { d: 1, m: "Português / Adm", t: ["lp-9", "da-6"] },
                { d: 2, m: "Const / Proc Civil", t: ["dc-6", "pc-7"] },
                { d: 3, m: "Leg Esp / Proc Penal", t: ["le-7", "pp-4"] },
                { d: 4, m: "PCD / Português", t: ["pcd-2", "lp-10"] },
                { d: 5, m: "Proc Civil / Proc Penal", t: ["pc-8", "pp-5"] },
                { d: 6, m: "Simulado Geral", t: ["lp-1", "pc-7"] },
                { d: 0, m: "Revisão Final", t: ["le-7"] }
            ]
        };

        let state = { week: 1, view: 'cronograma', doneTopics: [], blockScores: {} };
        let userUid = null;

        // Inicia Firebase Auth e App
        async function init() {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (e) {
                console.error("Auth falhou:", e);
            }

            onAuthStateChanged(auth, (u) => { 
                if (u) { 
                    userUid = u.uid; 
                    listen(); 
                } 
            });
            startCountdown();
        }

        // Monitora o progresso no Firestore
        function listen() {
            const docRef = doc(db, 'artifacts', appId, 'users', userUid, 'data', 'v3');
            onSnapshot(docRef, (s) => {
                if (s.exists()) {
                    state = { ...state, ...s.data() };
                }
                render();
            }, (err) => console.error("Snapshot error:", err));
        }

        // Salva o progresso
        async function save() { 
            if(!userUid) return;
            const docRef = doc(db, 'artifacts', appId, 'users', userUid, 'data', 'v3');
            await setDoc(docRef, state); 
        }

        // Lógica de Renderização e UI
        window.toggleTopic = (id) => {
            const idx = state.doneTopics.indexOf(id);
            if (idx > -1) state.doneTopics.splice(idx, 1);
            else state.doneTopics.push(id);
            save();
        };

        window.setBlockScore = (diaId, blockIdx, score) => {
            let val = score === "" ? null : parseFloat(score);
            if (val > 20) val = 20; 
            if (val < 0) val = 0;
            state.blockScores[`${diaId}-${blockIdx}`] = val;
            save();
        };

        window.setWeek = (w) => { state.week = w; render(); };
        window.setView = (v) => { state.view = v; render(); };

        window.highlightTarget = (view, week, targetId) => {
            state.view = view;
            state.week = week;
            render();
            setTimeout(() => {
                const prefix = view === 'cronograma' ? 'topic-' : 'edital-';
                const el = document.getElementById(prefix + targetId);
                if (el) {
                    el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    el.classList.add('highlight-active');
                    setTimeout(() => el.classList.remove('highlight-active'), 3000);
                }
            }, 300);
        };

        function startCountdown() {
            const target = new Date(2026, 0, 30, 0, 0, 0).getTime();
            setInterval(() => {
                const diff = target - Date.now();
                if (diff < 0) {
                    document.getElementById('countdown-timer').innerText = "PROVA CHEGOU!";
                    return;
                }
                const days = Math.floor(diff / 86400000);
                const hours = Math.floor((diff % 86400000) / 3600000);
                const mins = Math.floor((diff % 3600000) / 60000);
                const secs = Math.floor((diff % 60000) / 1000);
                
                document.getElementById('countdown-timer').innerText = 
                    `${String(days).padStart(2, '0')}d ${String(hours).padStart(2, '0')}h ${String(mins).padStart(2, '0')}m ${String(secs).padStart(2, '0')}s`;
            }, 1000);
        }

        function findTopic(id) {
            for (const cat in EDITAL) {
                const f = EDITAL[cat].find(x => x.id === id);
                if (f) return { ...f, cat };
            }
            return { id, t: "Não encontrado", sub: "-", cat: "Geral", week: 1, ref: "" };
        }

        function render() {
            const cronView = document.getElementById('view-cronograma');
            const editView = document.getElementById('view-edital');
            cronView.style.display = state.view === 'cronograma' ? 'block' : 'none';
            editView.style.display = state.view === 'edital' ? 'block' : 'none';

            document.getElementById('btn-cron').className = `px-4 py-2 rounded-lg text-xs font-black uppercase transition-all ${state.view === 'cronograma' ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-500'}`;
            document.getElementById('btn-edit').className = `px-4 py-2 rounded-lg text-xs font-black uppercase transition-all ${state.view === 'edital' ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-500'}`;

            document.getElementById('week-tabs').innerHTML = [1, 2, 3, 4].map(w => `
                <button onclick="setWeek(${w})" class="px-6 py-3 rounded-xl border-2 text-sm font-black uppercase whitespace-nowrap transition-all ${state.week == w ? 'bg-blue-600 text-white border-blue-600 shadow-md' : 'bg-white text-slate-400 border-slate-200'}">
                    Semana 0${w}
                </button>
            `).join('');

            const weekData = CRONOGRAMA_MAP[state.week] || [];
            const daysMap = ["Domingo", "Segunda", "Terça", "Quarta", "Quinta", "Sexta", "Sábado"];
            
            document.getElementById('week-content').innerHTML = weekData.map((dia, idx) => {
                const isWeekend = dia.d === 0 || dia.d === 6;
                const hoursTeoria = isWeekend ? "09:00 - 14:00" : "19:00 - 22:00";
                const hoursSimulado = isWeekend ? "14:00 - 17:00" : "22:00 - 00:00";
                
                return `
                <div class="bg-white rounded-2xl border-2 border-slate-100 overflow-hidden shadow-sm hover:shadow-md transition-shadow">
                    <div class="bg-slate-50 border-b-2 border-slate-100 px-5 py-3 flex justify-between items-center">
                        <div class="flex flex-col">
                            <span class="text-[10px] font-black text-blue-600 uppercase italic">${daysMap[dia.d]}</span>
                            <span class="text-lg font-black text-slate-800 uppercase tracking-tighter">${dia.m}</span>
                        </div>
                    </div>
                    <div class="p-5 flex flex-col lg:flex-row gap-6">
                        <div class="flex-1 space-y-3">
                            <p class="text-[11px] font-black text-slate-400 uppercase tracking-wide">Teoria: ${hoursTeoria}</p>
                            ${dia.t.map(tid => {
                                const topic = findTopic(tid);
                                const isDone = state.doneTopics.includes(tid);
                                return `
                                <div id="topic-${tid}" class="p-4 rounded-xl border-2 border-slate-50 flex items-center justify-between transition-all bg-white hover:border-blue-100">
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="text-[9px] font-black bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded">TÓPICO ${topic.sub}</span>
                                            <button onclick="highlightTarget('edital', ${topic.week}, '${tid}')" class="text-[9px] font-bold text-blue-400 hover:text-blue-600 underline uppercase italic">Ver Detalhes</button>
                                        </div>
                                        <p class="text-sm font-black text-slate-800 uppercase leading-tight">${topic.t}</p>
                                        <p class="text-[10px] text-slate-400 mt-1 font-semibold italic">${topic.ref}</p>
                                    </div>
                                    <button onclick="toggleTopic('${tid}')" class="ml-4 w-9 h-9 rounded-xl border-2 flex items-center justify-center transition-all ${isDone ? 'bg-blue-600 border-blue-600 shadow-sm' : 'border-slate-200 bg-white'}">
                                        ${isDone ? '<i data-lucide="check" class="w-5 h-5 text-white"></i>' : ''}
                                    </button>
                                </div>`;
                            }).join('')}
                        </div>

                        <div class="w-full lg:w-[320px] bg-slate-900 p-5 rounded-2xl border-2 border-slate-800 flex flex-col">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <p class="text-[10px] font-black text-blue-400 uppercase tracking-tighter">Simulado FGV</p>
                                    <p class="text-[12px] font-bold text-slate-400">${hoursSimulado}</p>
                                </div>
                                <div class="bg-blue-500/10 p-2 rounded-lg"><i data-lucide="target" class="w-5 h-5 text-blue-400"></i></div>
                            </div>
                            
                            <div class="questoes-grid">
                                ${Array.from({length: 10}).map((_, i) => {
                                    const score = state.blockScores[`${state.week}-${dia.d}-${i}`];
                                    return `
                                    <div class="flex flex-col gap-1">
                                        <input type="number" 
                                               value="${score !== undefined && score !== null ? score : ''}" 
                                               onchange="setBlockScore('${state.week}-${dia.d}', ${i}, this.value)" 
                                               placeholder="${i+1}" 
                                               step="1" min="0" max="20"
                                               class="bg-slate-800 border-2 border-slate-700 rounded-lg p-2 text-center text-sm font-black text-blue-400 outline-none focus:border-blue-500 transition-colors w-full">
                                    </div>`;
                                }).join('')}
                            </div>
                            <p class="text-[9px] text-slate-500 mt-4 text-center italic uppercase font-bold tracking-widest">Limite máximo: 20 acertos</p>
                        </div>
                    </div>
                </div>`;
            }).join('');

            document.getElementById('edital-content').innerHTML = Object.entries(EDITAL).map(([cat, tops]) => `
                <div class="bg-white p-6 rounded-2xl border-2 border-slate-100 shadow-sm self-start">
                    <h3 class="font-black text-sm uppercase italic text-blue-700 mb-5 border-l-4 border-blue-600 pl-3">${cat}</h3>
                    <div class="space-y-3">
                        ${tops.map(t => {
                            const isDone = state.doneTopics.includes(t.id);
                            return `
                                <div id="edital-${t.id}" class="flex flex-col p-3 rounded-xl border-2 ${isDone ? 'border-emerald-100 bg-emerald-50/30' : 'border-slate-50'}">
                                    <div class="flex items-center justify-between mb-1">
                                        <div class="flex items-center gap-3">
                                            <div class="w-3 h-3 rounded-full ${isDone ? 'bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.4)]' : 'bg-slate-200'}"></div>
                                            <div>
                                                <p class="text-[9px] font-bold text-slate-400">ITEM ${t.sub}</p>
                                                <p class="text-xs font-black uppercase text-slate-700 leading-tight">${t.t}</p>
                                            </div>
                                        </div>
                                        <button onclick="highlightTarget('cronograma', ${t.week}, '${t.id}')" class="text-[9px] font-black bg-blue-50 text-blue-600 px-2 py-1 rounded hover:bg-blue-600 hover:text-white transition-colors uppercase">S0${t.week}</button>
                                    </div>
                                    <div class="pl-6 border-l-2 border-slate-100 ml-1.5 mt-1">
                                        <p class="text-[10px] font-bold text-blue-600 uppercase italic leading-none">${t.ref}</p>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `).join('');

            const scoresValues = Object.values(state.blockScores).filter(v => v !== null);
            const mediaFinal = scoresValues.length ? (scoresValues.reduce((a,b)=>a+b,0) / scoresValues.length).toFixed(1) : "0.0";
            document.getElementById('avg-score').innerText = mediaFinal;
            
            let totalT = 0; Object.values(EDITAL).forEach(c => totalT += c.length);
            document.getElementById('topics-count').innerText = `${state.doneTopics.length}/${totalT}`;
            const perc = Math.round((state.doneTopics.length/totalT)*100) || 0;
            document.getElementById('perc-label').innerText = `${perc}%`;

            lucide.createIcons();
        }

        init();
    </script>
</body>

</html>
